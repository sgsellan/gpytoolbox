
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>gaussian_process - Gpytoolbox</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#00bdd6">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-YDMBBH2H8E"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-YDMBBH2H8E",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-YDMBBH2H8E"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="cyan" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.gpytoolbox.gaussian_process.gaussian_process_precompute" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Gpytoolbox" class="md-header__button md-logo" aria-label="Gpytoolbox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Gpytoolbox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              gaussian_process
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/sgsellan/gpytoolbox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sgsellan/gpytoolbox
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Gpytoolbox" class="md-nav__button md-logo" aria-label="Gpytoolbox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Gpytoolbox
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sgsellan/gpytoolbox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sgsellan/gpytoolbox
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../adjacency_matrix/" class="md-nav__link">
        adjacency_matrix
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../angle_defect/" class="md-nav__link">
        angle_defect
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../angle_defect_intrinsic/" class="md-nav__link">
        angle_defect_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../apply_colormap/" class="md-nav__link">
        apply_colormap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../approximate_hausdorff_distance/" class="md-nav__link">
        approximate_hausdorff_distance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../array_correspondence/" class="md-nav__link">
        array_correspondence
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../bad_quad_mesh_from_quadtree/" class="md-nav__link">
        bad_quad_mesh_from_quadtree
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../barycenters/" class="md-nav__link">
        barycenters
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../barycentric_coordinates/" class="md-nav__link">
        barycentric_coordinates
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../biharmonic_energy/" class="md-nav__link">
        biharmonic_energy
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../biharmonic_energy_intrinsic/" class="md-nav__link">
        biharmonic_energy_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../boundary_edges/" class="md-nav__link">
        boundary_edges
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../boundary_faces/" class="md-nav__link">
        boundary_faces
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../boundary_loops/" class="md-nav__link">
        boundary_loops
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../boundary_vertices/" class="md-nav__link">
        boundary_vertices
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../catmull_rom_spline/" class="md-nav__link">
        catmull_rom_spline
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../colormap/" class="md-nav__link">
        colormap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../compactly_supported_normal/" class="md-nav__link">
        compactly_supported_normal
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../compactly_supported_normal_kernel/" class="md-nav__link">
        compactly_supported_normal_kernel
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cone/" class="md-nav__link">
        cone
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../connected_components/" class="md-nav__link">
        connected_components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cotangent_laplacian/" class="md-nav__link">
        cotangent_laplacian
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cotangent_laplacian_intrinsic/" class="md-nav__link">
        cotangent_laplacian_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cotangent_weights/" class="md-nav__link">
        cotangent_weights
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cotangent_weights_intrinsic/" class="md-nav__link">
        cotangent_weights_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cut_edges/" class="md-nav__link">
        cut_edges
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cylinder/" class="md-nav__link">
        cylinder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../decimate/" class="md-nav__link">
        decimate
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../doublearea/" class="md-nav__link">
        doublearea
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../doublearea_intrinsic/" class="md-nav__link">
        doublearea_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../edge_edge_distance/" class="md-nav__link">
        edge_edge_distance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../edge_indices/" class="md-nav__link">
        edge_indices
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../edges/" class="md-nav__link">
        edges
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faces/" class="md-nav__link">
        faces
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fast_winding_number/" class="md-nav__link">
        fast_winding_number
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fd_grad/" class="md-nav__link">
        fd_grad
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fd_interpolate/" class="md-nav__link">
        fd_interpolate
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fd_partial_derivative/" class="md-nav__link">
        fd_partial_derivative
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fixed_dof_solve/" class="md-nav__link">
        fixed_dof_solve
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          gaussian_process
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        gaussian_process
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process_precompute" class="md-nav__link">
    gaussian_process_precompute
  </a>
  
    <nav class="md-nav" aria-label="gaussian_process_precompute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process_precompute.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process_precompute.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process" class="md-nav__link">
    gaussian_process()
  </a>
  
    <nav class="md-nav" aria-label="gaussian_process()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../grad/" class="md-nav__link">
        grad
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../grad_intrinsic/" class="md-nav__link">
        grad_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../grid_laplacian_eigenfunctions/" class="md-nav__link">
        grid_laplacian_eigenfunctions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../grid_neighbors/" class="md-nav__link">
        grid_neighbors
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../halfedge_edge_map/" class="md-nav__link">
        halfedge_edge_map
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../halfedge_lengths/" class="md-nav__link">
        halfedge_lengths
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../halfedge_lengths_squared/" class="md-nav__link">
        halfedge_lengths_squared
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../halfedges/" class="md-nav__link">
        halfedges
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../halffaces/" class="md-nav__link">
        halffaces
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../icosphere/" class="md-nav__link">
        icosphere
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../in_element_aabb/" class="md-nav__link">
        in_element_aabb
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../in_quadtree/" class="md-nav__link">
        in_quadtree
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../initialize_aabbtree/" class="md-nav__link">
        initialize_aabbtree
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../initialize_quadtree/" class="md-nav__link">
        initialize_quadtree
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../linear_blend_skinning/" class="md-nav__link">
        linear_blend_skinning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../linear_elasticity/" class="md-nav__link">
        linear_elasticity
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../linear_elasticity_stiffness/" class="md-nav__link">
        linear_elasticity_stiffness
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../marching_cubes/" class="md-nav__link">
        marching_cubes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../marching_squares/" class="md-nav__link">
        marching_squares
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../massmatrix/" class="md-nav__link">
        massmatrix
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../massmatrix_intrinsic/" class="md-nav__link">
        massmatrix_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../matrix_from_function/" class="md-nav__link">
        matrix_from_function
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../metropolis_hastings/" class="md-nav__link">
        metropolis_hastings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../min_quad_with_fixed/" class="md-nav__link">
        min_quad_with_fixed
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../minimum_distance/" class="md-nav__link">
        minimum_distance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../non_manifold_edges/" class="md-nav__link">
        non_manifold_edges
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../normalize_points/" class="md-nav__link">
        normalize_points
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../offset_surface/" class="md-nav__link">
        offset_surface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../particle_swarm/" class="md-nav__link">
        particle_swarm
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../per_face_normals/" class="md-nav__link">
        per_face_normals
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../per_vertex_normals/" class="md-nav__link">
        per_vertex_normals
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../png2poly/" class="md-nav__link">
        png2poly
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../poisson_surface_reconstruction/" class="md-nav__link">
        poisson_surface_reconstruction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quadtree_boundary/" class="md-nav__link">
        quadtree_boundary
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quadtree_children/" class="md-nav__link">
        quadtree_children
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quadtree_gradient/" class="md-nav__link">
        quadtree_gradient
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quadtree_laplacian/" class="md-nav__link">
        quadtree_laplacian
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../random_points_on_mesh/" class="md-nav__link">
        random_points_on_mesh
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ray_box_intersect/" class="md-nav__link">
        ray_box_intersect
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ray_mesh_intersect/" class="md-nav__link">
        ray_mesh_intersect
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ray_polyline_intersect/" class="md-nav__link">
        ray_polyline_intersect
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ray_triangle_intersect/" class="md-nav__link">
        ray_triangle_intersect
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../reach_for_the_spheres/" class="md-nav__link">
        reach_for_the_spheres
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../read_dmat/" class="md-nav__link">
        read_dmat
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../read_mesh/" class="md-nav__link">
        read_mesh
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../regular_circle_polyline/" class="md-nav__link">
        regular_circle_polyline
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../regular_cube_mesh/" class="md-nav__link">
        regular_cube_mesh
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../regular_square_mesh/" class="md-nav__link">
        regular_square_mesh
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../remesh_botsch/" class="md-nav__link">
        remesh_botsch
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../remove_duplicate_vertices/" class="md-nav__link">
        remove_duplicate_vertices
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../remove_unreferenced/" class="md-nav__link">
        remove_unreferenced
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../signed_distance/" class="md-nav__link">
        signed_distance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../signed_distance_polygon/" class="md-nav__link">
        signed_distance_polygon
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../squared_distance/" class="md-nav__link">
        squared_distance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../squared_distance_to_element/" class="md-nav__link">
        squared_distance_to_element
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../squared_exponential_kernel/" class="md-nav__link">
        squared_exponential_kernel
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../subdivide/" class="md-nav__link">
        subdivide
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../subdivide_quad/" class="md-nav__link">
        subdivide_quad
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tip_angles/" class="md-nav__link">
        tip_angles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tip_angles_intrinsic/" class="md-nav__link">
        tip_angles_intrinsic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../torus/" class="md-nav__link">
        torus
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../traverse_aabbtree/" class="md-nav__link">
        traverse_aabbtree
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../triangle_triangle_adjacency/" class="md-nav__link">
        triangle_triangle_adjacency
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../triangle_triangle_distance/" class="md-nav__link">
        triangle_triangle_distance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../upper_envelope/" class="md-nav__link">
        upper_envelope
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../volume/" class="md-nav__link">
        volume
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../winding_number/" class="md-nav__link">
        winding_number
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../write_mesh/" class="md-nav__link">
        write_mesh
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_110" type="checkbox" id="__nav_110" >
      
      
      
      
        <label class="md-nav__link" for="__nav_110">
          Copyleft
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Copyleft" data-md-level="1">
        <label class="md-nav__title" for="__nav_110">
          <span class="md-nav__icon md-icon"></span>
          Copyleft
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../copyleft/do_meshes_intersect/" class="md-nav__link">
        copyleft.do_meshes_intersect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../copyleft/lazy_cage/" class="md-nav__link">
        copyleft.lazy_cage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../copyleft/mesh_boolean/" class="md-nav__link">
        copyleft.mesh_boolean
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../copyleft/swept_volume/" class="md-nav__link">
        copyleft.swept_volume
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process_precompute" class="md-nav__link">
    gaussian_process_precompute
  </a>
  
    <nav class="md-nav" aria-label="gaussian_process_precompute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process_precompute.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process_precompute.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process" class="md-nav__link">
    gaussian_process()
  </a>
  
    <nav class="md-nav" aria-label="gaussian_process()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.gpytoolbox.gaussian_process.gaussian_process--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/sgsellan/gpytoolbox/edit/master/docs/gaussian_process.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>gaussian_process</h1>

<div class="doc doc-object doc-module">



  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="src.gpytoolbox.gaussian_process.gaussian_process_precompute" class="doc doc-heading">
        <code>gaussian_process_precompute</code>


</h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>src/gpytoolbox/gaussian_process.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">gaussian_process_precompute</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">X_induced</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">grad_y_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sigma_n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span><span class="n">lump_K3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">compact_kernel</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fits a gaussian process to existing training data, storing all necessary information to later evaluate it at any given test points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X_train : (num_train, num_dim) numpy array</span>
<span class="sd">            Training data points coordinates.</span>
<span class="sd">        y_train : (num_train, 1) numpy array</span>
<span class="sd">            Value of the function at the training data points.</span>
<span class="sd">        kernel : function, optional (default None)</span>
<span class="sd">            Kernel function that takes two coordinate matrices as input and returns a vector of values; e.g., k = kernel(X1,X2). If `grad_y_train` is not None, this function should also accept a `derivatives=(i,j)` argument, where `i` and `j` are integers between -1 and `num_dim`-1, and return the partial derivative of the kernel with respect to the (first) the `i`-th and (second) `j`-th coordinates of the training data points (-1 denoting no derivative). If None, the squared exponential kernel is used.</span>
<span class="sd">        X_induced : (num_induced, num_dim) numpy array, optional (default None)</span>
<span class="sd">            Inducing points coordinates (see e.g., https://ludwigwinkler.github.io/blog/InducingPoints/). If None, the training data points are used as inducing points.</span>
<span class="sd">        grad_y_train : (num_train, num_dim) numpy array, optional (default None)</span>
<span class="sd">            Observed gradient of the function at the training data points. If None, the gradient is not used.</span>
<span class="sd">        verbose : bool, optional (default False)</span>
<span class="sd">            If True, prints information about the training.</span>
<span class="sd">        sigma_n : float, optional (default 0.02)</span>
<span class="sd">            Noise standard deviation.</span>
<span class="sd">        lump_K3 : bool, optional (default False)</span>
<span class="sd">            If True, lump the sample covariance matrix K3. Useful if the number of training points is large.</span>
<span class="sd">        compact_kernel : bool, optional (default False)</span>
<span class="sd">            If True, will try to find the kernel&#39;s compact support and only evaluate it for points in that neighborhood, to save time. Kernel must be radially symmetric, isotropic, and positive definite.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        precomputed_gaussian_process : instance of class gaussian_process_precompute</span>
<span class="sd">            Object that stores all necessary information to later evaluate the gaussian process at any given test points.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">time</span>
            <span class="n">t_train_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="c1"># Store parameteers</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span> <span class="o">=</span> <span class="n">sigma_n</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">grad_y_train</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_train</span> <span class="o">=</span> <span class="n">grad_y_train</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_y_train</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># This part is independent of test data</span>

        <span class="c1"># Default kernel</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">kernel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">squared_exponential_kernel</span>
            <span class="n">compact_kernel</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">compact_kernel</span><span class="p">:</span>
            <span class="c1"># This is a hack</span>
            <span class="n">xzero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">k1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">mid</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span>
                <span class="n">kmid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">mid</span><span class="p">)</span>
                <span class="c1"># k2 will always be zero, k1 will always be positive</span>
                <span class="k">if</span> <span class="n">kmid</span><span class="o">&gt;</span><span class="mf">1e-10</span><span class="p">:</span>
                    <span class="n">x1</span> <span class="o">=</span> <span class="n">mid</span>
                    <span class="n">k1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x2</span> <span class="o">=</span> <span class="n">mid</span>
                    <span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># print(&quot;Compact support found: &quot;, self.compact_support)</span>

        <span class="c1"># assert False</span>

        <span class="c1"># We prefactorize everything</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">X_induced</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------- Training Gaussian Process with&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;data points and&quot;</span><span class="p">,</span><span class="n">X_induced</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;induced points. ---------&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inducing_points</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">assert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_induced</span> <span class="o">=</span> <span class="n">X_induced</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_induced</span><span class="p">,</span><span class="n">X_induced</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
            <span class="n">Kmn</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_induced</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SIGMA_INV</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span><span class="o">*</span><span class="n">Kmn</span><span class="o">*</span><span class="n">Kmn</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sigma_LU</span> <span class="o">=</span> <span class="n">splu</span><span class="p">(</span><span class="n">csc_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIGMA_INV</span><span class="p">))</span>
            <span class="c1"># print((Kmn*y_train).shape)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mu_m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span><span class="o">*</span><span class="n">cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIGMA_INV</span><span class="p">,</span><span class="n">Kmn</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">=</span> <span class="n">splu</span><span class="p">(</span><span class="n">csc_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span><span class="p">))</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">Kmm_inv_mu_m</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_m</span><span class="p">)</span>
            <span class="c1"># self.A_m = self.Kmm*self.sigma_LU.solve(self.Kmm.toarray())</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------- Training Gaussian Process with&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;data points. ---------&quot;</span><span class="p">)</span>
            <span class="n">K3</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">,</span><span class="n">compact_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span><span class="p">)</span>        
            <span class="k">if</span> <span class="n">lump_K3</span><span class="p">:</span>
                <span class="n">K3</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">K3</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inducing_points</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">=</span> <span class="n">splu</span><span class="p">(</span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">K3</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">eye</span><span class="p">(</span><span class="n">K3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="c1"># plt.spy(K3)</span>
            <span class="c1"># plt.show()</span>
            <span class="c1"># self.K3_inv_y = self.LU.solve(self.y_train)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">K3_inv_y</span> <span class="o">=</span> <span class="n">cg</span><span class="p">(</span><span class="n">K3</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">eye</span><span class="p">(</span><span class="n">K3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># debug</span>
            <span class="c1"># self.K3_inv_y = self.LU.solve(self.y_train)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Timing</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">t_train_1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">t_train</span> <span class="o">=</span> <span class="n">t_train_1</span> <span class="o">-</span> <span class="n">t_train_0</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training time:&quot;</span><span class="p">,</span><span class="n">t_train</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">mean_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates a precomputed gaussian process at the points X_test.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X_test : (num_test, dim) numpy array</span>
<span class="sd">            The points at which to evaluate the gaussian process.</span>
<span class="sd">        mean_only : bool</span>
<span class="sd">            If True, only the mean of the gaussian process is computed (this is significantly faster). The var output is None.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mean : (num_test,) numpy array</span>
<span class="sd">            The mean of the gaussian process at the points X_test.</span>
<span class="sd">        var : (num_test,num_test) numpy array</span>
<span class="sd">            The covariance matrix of the gaussian process at the points X_test.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">time</span>
            <span class="n">t_test_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Building K1 matrix...&quot;</span><span class="p">)</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...built K1 matrix in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inducing_points</span><span class="p">):</span>
            <span class="n">K2</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">X_induced</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">,</span><span class="n">compact_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span><span class="p">)</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kmm_inv_mu_m</span>
            <span class="n">lu_solve_K2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">K2</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
            <span class="c1"># cov = K1 - K2.T @ lu_solve_K2 + lu_solve_K2.T @ self.A_m @ lu_solve_K2</span>
            <span class="k">if</span> <span class="n">mean_only</span><span class="p">:</span>
                <span class="n">cov</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">K1</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
                <span class="n">cov</span> <span class="o">=</span> <span class="n">K1</span> <span class="o">-</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">lu_solve_K2</span> <span class="o">+</span> <span class="n">lu_solve_K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_LU</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">@</span> <span class="n">lu_solve_K2</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>           
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Building K2 matrix...&quot;</span><span class="p">)</span>
                <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">K2</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">,</span><span class="n">compact_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...built K2 matrix in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing mean...&quot;</span><span class="p">)</span>
                <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">K3_inv_y</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...computed mean in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing covariance...&quot;</span><span class="p">)</span>
                <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">mean_only</span><span class="p">:</span>
                <span class="n">cov</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">K1</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
                <span class="n">cov</span> <span class="o">=</span> <span class="n">K1</span> <span class="o">-</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">K2</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...computed covariance in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">t_test_1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">t_test</span> <span class="o">=</span> <span class="n">t_test_1</span> <span class="o">-</span> <span class="n">t_test_0</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total test time:&quot;</span><span class="p">,</span><span class="n">t_test</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">cov</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="src.gpytoolbox.gaussian_process.gaussian_process_precompute.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_induced</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grad_y_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma_n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">lump_K3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compact_kernel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Fits a gaussian process to existing training data, storing all necessary information to later evaluate it at any given test points.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X_train</code></td>
          <td>
                <code>(num_train, num_dim) numpy array</code>
          </td>
          <td><p>Training data points coordinates.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_train</code></td>
          <td>
                <code>(num_train, 1) numpy array</code>
          </td>
          <td><p>Value of the function at the training data points.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kernel</code></td>
          <td>
                <code>function, optional (default None)</code>
          </td>
          <td><p>Kernel function that takes two coordinate matrices as input and returns a vector of values; e.g., k = kernel(X1,X2). If <code>grad_y_train</code> is not None, this function should also accept a <code>derivatives=(i,j)</code> argument, where <code>i</code> and <code>j</code> are integers between -1 and <code>num_dim</code>-1, and return the partial derivative of the kernel with respect to the (first) the <code>i</code>-th and (second) <code>j</code>-th coordinates of the training data points (-1 denoting no derivative). If None, the squared exponential kernel is used.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>X_induced</code></td>
          <td>
                <code>(num_induced, num_dim) numpy array, optional (default None)</code>
          </td>
          <td><p>Inducing points coordinates (see e.g., https://ludwigwinkler.github.io/blog/InducingPoints/). If None, the training data points are used as inducing points.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>grad_y_train</code></td>
          <td>
                <code>(num_train, num_dim) numpy array, optional (default None)</code>
          </td>
          <td><p>Observed gradient of the function at the training data points. If None, the gradient is not used.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool, optional (default False)</code>
          </td>
          <td><p>If True, prints information about the training.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma_n</code></td>
          <td>
                <code>float, optional (default 0.02)</code>
          </td>
          <td><p>Noise standard deviation.</p></td>
          <td>
                <code>0.02</code>
          </td>
        </tr>
        <tr>
          <td><code>lump_K3</code></td>
          <td>
                <code>bool, optional (default False)</code>
          </td>
          <td><p>If True, lump the sample covariance matrix K3. Useful if the number of training points is large.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>compact_kernel</code></td>
          <td>
                <code>bool, optional (default False)</code>
          </td>
          <td><p>If True, will try to find the kernel's compact support and only evaluate it for points in that neighborhood, to save time. Kernel must be radially symmetric, isotropic, and positive definite.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>precomputed_gaussian_process</code></td>          <td>
                <code>instance of class gaussian_process_precompute</code>
          </td>
          <td><p>Object that stores all necessary information to later evaluate the gaussian process at any given test points.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/gpytoolbox/gaussian_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">X_induced</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">grad_y_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sigma_n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span><span class="n">lump_K3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">compact_kernel</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fits a gaussian process to existing training data, storing all necessary information to later evaluate it at any given test points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X_train : (num_train, num_dim) numpy array</span>
<span class="sd">        Training data points coordinates.</span>
<span class="sd">    y_train : (num_train, 1) numpy array</span>
<span class="sd">        Value of the function at the training data points.</span>
<span class="sd">    kernel : function, optional (default None)</span>
<span class="sd">        Kernel function that takes two coordinate matrices as input and returns a vector of values; e.g., k = kernel(X1,X2). If `grad_y_train` is not None, this function should also accept a `derivatives=(i,j)` argument, where `i` and `j` are integers between -1 and `num_dim`-1, and return the partial derivative of the kernel with respect to the (first) the `i`-th and (second) `j`-th coordinates of the training data points (-1 denoting no derivative). If None, the squared exponential kernel is used.</span>
<span class="sd">    X_induced : (num_induced, num_dim) numpy array, optional (default None)</span>
<span class="sd">        Inducing points coordinates (see e.g., https://ludwigwinkler.github.io/blog/InducingPoints/). If None, the training data points are used as inducing points.</span>
<span class="sd">    grad_y_train : (num_train, num_dim) numpy array, optional (default None)</span>
<span class="sd">        Observed gradient of the function at the training data points. If None, the gradient is not used.</span>
<span class="sd">    verbose : bool, optional (default False)</span>
<span class="sd">        If True, prints information about the training.</span>
<span class="sd">    sigma_n : float, optional (default 0.02)</span>
<span class="sd">        Noise standard deviation.</span>
<span class="sd">    lump_K3 : bool, optional (default False)</span>
<span class="sd">        If True, lump the sample covariance matrix K3. Useful if the number of training points is large.</span>
<span class="sd">    compact_kernel : bool, optional (default False)</span>
<span class="sd">        If True, will try to find the kernel&#39;s compact support and only evaluate it for points in that neighborhood, to save time. Kernel must be radially symmetric, isotropic, and positive definite.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    precomputed_gaussian_process : instance of class gaussian_process_precompute</span>
<span class="sd">        Object that stores all necessary information to later evaluate the gaussian process at any given test points.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">time</span>
        <span class="n">t_train_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1"># Store parameteers</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span> <span class="o">=</span> <span class="n">sigma_n</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">grad_y_train</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_train</span> <span class="o">=</span> <span class="n">grad_y_train</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_y_train</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># This part is independent of test data</span>

    <span class="c1"># Default kernel</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">kernel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">squared_exponential_kernel</span>
        <span class="n">compact_kernel</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">compact_kernel</span><span class="p">:</span>
        <span class="c1"># This is a hack</span>
        <span class="n">xzero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span>
            <span class="n">kmid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">mid</span><span class="p">)</span>
            <span class="c1"># k2 will always be zero, k1 will always be positive</span>
            <span class="k">if</span> <span class="n">kmid</span><span class="o">&gt;</span><span class="mf">1e-10</span><span class="p">:</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">mid</span>
                <span class="n">k1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">mid</span>
                <span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># print(&quot;Compact support found: &quot;, self.compact_support)</span>

    <span class="c1"># assert False</span>

    <span class="c1"># We prefactorize everything</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">X_induced</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------- Training Gaussian Process with&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;data points and&quot;</span><span class="p">,</span><span class="n">X_induced</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;induced points. ---------&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inducing_points</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">assert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_induced</span> <span class="o">=</span> <span class="n">X_induced</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_induced</span><span class="p">,</span><span class="n">X_induced</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
        <span class="n">Kmn</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_induced</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SIGMA_INV</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span><span class="o">*</span><span class="n">Kmn</span><span class="o">*</span><span class="n">Kmn</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_LU</span> <span class="o">=</span> <span class="n">splu</span><span class="p">(</span><span class="n">csc_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIGMA_INV</span><span class="p">))</span>
        <span class="c1"># print((Kmn*y_train).shape)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mu_m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span><span class="o">*</span><span class="n">cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIGMA_INV</span><span class="p">,</span><span class="n">Kmn</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">=</span> <span class="n">splu</span><span class="p">(</span><span class="n">csc_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span><span class="p">))</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">Kmm_inv_mu_m</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">cg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_m</span><span class="p">)</span>
        <span class="c1"># self.A_m = self.Kmm*self.sigma_LU.solve(self.Kmm.toarray())</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------- Training Gaussian Process with&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;data points. ---------&quot;</span><span class="p">)</span>
        <span class="n">K3</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">,</span><span class="n">compact_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span><span class="p">)</span>        
        <span class="k">if</span> <span class="n">lump_K3</span><span class="p">:</span>
            <span class="n">K3</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">K3</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inducing_points</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">=</span> <span class="n">splu</span><span class="p">(</span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">K3</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">eye</span><span class="p">(</span><span class="n">K3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="c1"># plt.spy(K3)</span>
        <span class="c1"># plt.show()</span>
        <span class="c1"># self.K3_inv_y = self.LU.solve(self.y_train)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K3_inv_y</span> <span class="o">=</span> <span class="n">cg</span><span class="p">(</span><span class="n">K3</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_n</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">eye</span><span class="p">(</span><span class="n">K3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># debug</span>
        <span class="c1"># self.K3_inv_y = self.LU.solve(self.y_train)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Timing</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">t_train_1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">t_train</span> <span class="o">=</span> <span class="n">t_train_1</span> <span class="o">-</span> <span class="n">t_train_0</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training time:&quot;</span><span class="p">,</span><span class="n">t_train</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.gpytoolbox.gaussian_process.gaussian_process_precompute.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">mean_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Evaluates a precomputed gaussian process at the points X_test.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X_test</code></td>
          <td>
                <code>(num_test, dim) numpy array</code>
          </td>
          <td><p>The points at which to evaluate the gaussian process.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mean_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, only the mean of the gaussian process is computed (this is significantly faster). The var output is None.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>Returns</code></td>
          <td>
          </td>
          <td></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mean</code></td>
          <td>
                <code>(num_test,) numpy array</code>
          </td>
          <td><p>The mean of the gaussian process at the points X_test.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>var</code></td>
          <td>
                <code>(num_test,num_test) numpy array</code>
          </td>
          <td><p>The covariance matrix of the gaussian process at the points X_test.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src/gpytoolbox/gaussian_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">mean_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates a precomputed gaussian process at the points X_test.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X_test : (num_test, dim) numpy array</span>
<span class="sd">        The points at which to evaluate the gaussian process.</span>
<span class="sd">    mean_only : bool</span>
<span class="sd">        If True, only the mean of the gaussian process is computed (this is significantly faster). The var output is None.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mean : (num_test,) numpy array</span>
<span class="sd">        The mean of the gaussian process at the points X_test.</span>
<span class="sd">    var : (num_test,num_test) numpy array</span>
<span class="sd">        The covariance matrix of the gaussian process at the points X_test.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">num_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">time</span>
        <span class="n">t_test_0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Building K1 matrix...&quot;</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...built K1 matrix in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inducing_points</span><span class="p">):</span>
        <span class="n">K2</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">X_induced</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">,</span><span class="n">compact_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kmm_inv_mu_m</span>
        <span class="n">lu_solve_K2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">K2</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
        <span class="c1"># cov = K1 - K2.T @ lu_solve_K2 + lu_solve_K2.T @ self.A_m @ lu_solve_K2</span>
        <span class="k">if</span> <span class="n">mean_only</span><span class="p">:</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">K1</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="n">K1</span> <span class="o">-</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">lu_solve_K2</span> <span class="o">+</span> <span class="n">lu_solve_K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_LU</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kmm</span> <span class="o">@</span> <span class="n">lu_solve_K2</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>           
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Building K2 matrix...&quot;</span><span class="p">)</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">K2</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">,</span><span class="n">compact_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact_support</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...built K2 matrix in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing mean...&quot;</span><span class="p">)</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">K3_inv_y</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...computed mean in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing covariance...&quot;</span><span class="p">)</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mean_only</span><span class="p">:</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">K1</span> <span class="o">=</span> <span class="n">cov_matrix_from_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">use_gradients</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_gradients</span><span class="p">)</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="n">K1</span> <span class="o">-</span> <span class="n">K2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">K2</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;...computed covariance in&quot;</span><span class="p">,</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">t_test_1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">t_test</span> <span class="o">=</span> <span class="n">t_test_1</span> <span class="o">-</span> <span class="n">t_test_0</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total test time:&quot;</span><span class="p">,</span><span class="n">t_test</span><span class="p">,</span><span class="s2">&quot;seconds.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">cov</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="src.gpytoolbox.gaussian_process.gaussian_process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gaussian_process</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">X_induced</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grad_y_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lump_K3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compact_kernel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sigma_n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Uses a gaussian process to fit existing training data and evaluates it at new test points, returning a vector of means and a covariance matrix.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X_train</code></td>
          <td>
                <code>(num_train, num_dim) numpy array</code>
          </td>
          <td><p>Training data points coordinates.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_train</code></td>
          <td>
                <code>(num_train, 1) numpy array</code>
          </td>
          <td><p>Value of the function at the training data points.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>X_test</code></td>
          <td>
                <code>(num_test, num_dim) numpy array</code>
          </td>
          <td><p>Test data points coordinates.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kernel</code></td>
          <td>
                <code>function, optional (default None)</code>
          </td>
          <td><p>Kernel function that takes two coordinate matrices as input and returns a vector of values; e.g., k = kernel(X1,X2). If <code>grad_y_train</code> is not None, this function should also accept a <code>derivatives=(i,j)</code> argument, where <code>i</code> and <code>j</code> are integers between -1 and <code>num_dim</code>-1, and return the partial derivative of the kernel with respect to the (first) the <code>i</code>-th and (second) <code>j</code>-th coordinates of the training data points (-1 denoting no derivative, see <code>squared_exponential_kernel</code>). If None, the squared exponential kernel is used.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>X_induced</code></td>
          <td>
                <code>(num_induced, num_dim) numpy array, optional (default None)</code>
          </td>
          <td><p>Inducing points coordinates (see e.g., https://ludwigwinkler.github.io/blog/InducingPoints/). If None, the training data points are used as inducing points.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>grad_y_train</code></td>
          <td>
                <code>(num_train, num_dim) numpy array, optional (default None)</code>
          </td>
          <td><p>Observed gradient of the function at the training data points. If None, the gradient is not used.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool, optional (default False)</code>
          </td>
          <td><p>If True, prints information about the training.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma_n</code></td>
          <td>
                <code>float, optional (default 0.02)</code>
          </td>
          <td><p>Noise standard deviation.</p></td>
          <td>
                <code>0.02</code>
          </td>
        </tr>
        <tr>
          <td><code>lump_K3</code></td>
          <td>
                <code>bool, optional (default False)</code>
          </td>
          <td><p>If True, lump the sample covariance matrix K3. Useful if the number of training points is large.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>compact_kernel</code></td>
          <td>
                <code>bool, optional (default False)</code>
          </td>
          <td><p>If True, will try to find the kernel's compact support and only evaluate it for points in that neighborhood, to save time. Kernel must be radially symmetric, isotropic, and positive definite.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mu</code></td>          <td>
                <code>(num_test,) numpy array</code>
          </td>
          <td><p>Mean of the gaussian process at the test data points.</p></td>
        </tr>
        <tr>
<td><code>sigma</code></td>          <td>
                <code>(num_test, num_test) numpy array</code>
          </td>
          <td><p>Covariance matrix of the gaussian process at the test data points.</p></td>
        </tr>
    </tbody>
  </table>
      <h4 id="src.gpytoolbox.gaussian_process.gaussian_process--see-also">See also</h4>
<p>squared_exponential_kernel, compactly_supported_normal</p>
<h4 id="src.gpytoolbox.gaussian_process.gaussian_process--notes">Notes</h4>
<p>This function is a wrapper for the <code>gaussian_process_precompute</code> class, which stores all necessary information to later evaluate the gaussian process at any given test points.  This is useful if the same training data is used to evaluate the gaussian process at multiple test points, as it avoids recomputing the same quantities multiple times.</p>

<p><strong>Examples:</strong></p>
    <pre><code class="language-python">import numpy as np
import gpytoolbox
# Choose a simple function
def true_fun(x):
    return 10*x
def true_grad(x):
    return 10 + 0*x
# Trye to fit it with a gaussian process to a limited training set
x_train = np.linspace(0,1,5)
y_train = true_fun(x_train)
y_grad = true_grad(x_train)
# Test points
x_test = np.linspace(0,1,140)
# Call to Gaussian Process
y_test_mean,y_test_cov = gpytoolbox.gaussian_process(np.reshape(x_train,(-1,1)),y_train,np.reshape(x_test,(-1,1)),grad_y_train=y_grad,verbose=True)
</code></pre>

      <details class="quote">
        <summary>Source code in <code>src/gpytoolbox/gaussian_process.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gaussian_process</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">X_induced</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">grad_y_train</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">lump_K3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">compact_kernel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sigma_n</span><span class="o">=</span><span class="mf">0.02</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses a gaussian process to fit existing training data and evaluates it at new test points, returning a vector of means and a covariance matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X_train : (num_train, num_dim) numpy array</span>
<span class="sd">        Training data points coordinates.</span>
<span class="sd">    y_train : (num_train, 1) numpy array</span>
<span class="sd">        Value of the function at the training data points.</span>
<span class="sd">    X_test : (num_test, num_dim) numpy array</span>
<span class="sd">        Test data points coordinates.</span>
<span class="sd">    kernel : function, optional (default None)</span>
<span class="sd">        Kernel function that takes two coordinate matrices as input and returns a vector of values; e.g., k = kernel(X1,X2). If `grad_y_train` is not None, this function should also accept a `derivatives=(i,j)` argument, where `i` and `j` are integers between -1 and `num_dim`-1, and return the partial derivative of the kernel with respect to the (first) the `i`-th and (second) `j`-th coordinates of the training data points (-1 denoting no derivative, see `squared_exponential_kernel`). If None, the squared exponential kernel is used.</span>
<span class="sd">    X_induced : (num_induced, num_dim) numpy array, optional (default None)</span>
<span class="sd">        Inducing points coordinates (see e.g., https://ludwigwinkler.github.io/blog/InducingPoints/). If None, the training data points are used as inducing points.</span>
<span class="sd">    grad_y_train : (num_train, num_dim) numpy array, optional (default None)</span>
<span class="sd">        Observed gradient of the function at the training data points. If None, the gradient is not used.</span>
<span class="sd">    verbose : bool, optional (default False)</span>
<span class="sd">        If True, prints information about the training.</span>
<span class="sd">    sigma_n : float, optional (default 0.02)</span>
<span class="sd">        Noise standard deviation.</span>
<span class="sd">    lump_K3 : bool, optional (default False)</span>
<span class="sd">        If True, lump the sample covariance matrix K3. Useful if the number of training points is large.</span>
<span class="sd">    compact_kernel : bool, optional (default False)</span>
<span class="sd">        If True, will try to find the kernel&#39;s compact support and only evaluate it for points in that neighborhood, to save time. Kernel must be radially symmetric, isotropic, and positive definite.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mu : (num_test,) numpy array</span>
<span class="sd">        Mean of the gaussian process at the test data points.</span>
<span class="sd">    sigma : (num_test, num_test) numpy array</span>
<span class="sd">        Covariance matrix of the gaussian process at the test data points.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    squared_exponential_kernel, compactly_supported_normal</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function is a wrapper for the `gaussian_process_precompute` class, which stores all necessary information to later evaluate the gaussian process at any given test points.  This is useful if the same training data is used to evaluate the gaussian process at multiple test points, as it avoids recomputing the same quantities multiple times.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import numpy as np</span>
<span class="sd">    import gpytoolbox</span>
<span class="sd">    # Choose a simple function</span>
<span class="sd">    def true_fun(x):</span>
<span class="sd">        return 10*x</span>
<span class="sd">    def true_grad(x):</span>
<span class="sd">        return 10 + 0*x</span>
<span class="sd">    # Trye to fit it with a gaussian process to a limited training set</span>
<span class="sd">    x_train = np.linspace(0,1,5)</span>
<span class="sd">    y_train = true_fun(x_train)</span>
<span class="sd">    y_grad = true_grad(x_train)</span>
<span class="sd">    # Test points</span>
<span class="sd">    x_test = np.linspace(0,1,140)</span>
<span class="sd">    # Call to Gaussian Process</span>
<span class="sd">    y_test_mean,y_test_cov = gpytoolbox.gaussian_process(np.reshape(x_train,(-1,1)),y_train,np.reshape(x_test,(-1,1)),grad_y_train=y_grad,verbose=True)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">gaussian_process_precompute</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">X_induced</span><span class="o">=</span><span class="n">X_induced</span><span class="p">,</span><span class="n">grad_y_train</span><span class="o">=</span><span class="n">grad_y_train</span><span class="p">,</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span><span class="n">sigma_n</span><span class="o">=</span><span class="n">sigma_n</span><span class="p">,</span><span class="n">lump_K3</span><span class="o">=</span><span class="n">lump_K3</span><span class="p">,</span><span class="n">compact_kernel</span><span class="o">=</span><span class="n">compact_kernel</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../fixed_dof_solve/" class="md-footer__link md-footer__link--prev" aria-label="Previous: fixed_dof_solve" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              fixed_dof_solve
            </div>
          </div>
        </a>
      
      
        
        <a href="../grad/" class="md-footer__link md-footer__link--next" aria-label="Next: grad" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              grad
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>